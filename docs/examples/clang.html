
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>C &#8212; pyAutoMark 0.8.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Embedded C using the C mock fixtures" href="cmock.html" />
    <link rel="prev" title="write-csv" href="../cmds/write-csv.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cmock.html" title="Embedded C using the C mock fixtures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../cmds/write-csv.html" title="write-csv"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyAutoMark 0.8.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">C</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="c">
<span id="example-c"></span><h1>C<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h1>
<p>pyAutoMark can detect simple C unit test files in the tests directory.</p>
<section id="directory-structure">
<h2>Directory structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<p>Below is the directory structure for these tests. Under the cohort directory we will have a directory for each student which will
contain their submitted code - in this case <code class="file docutils literal notranslate"><span class="pre">Q1.c</span></code> and <code class="file docutils literal notranslate"><span class="pre">Q2.c</span></code>. In our tests folder for the cohort we have the C unit test files <code class="file docutils literal notranslate"><span class="pre">test1_Q1.c</span></code>, <code class="file docutils literal notranslate"><span class="pre">test1_Q1.c</span></code> etc. The
unittest files must start with “test_” and must contain some definitions to be recognised as test files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root
├─ cohorts
│     ├─ cohort1
│     │   └─ student1
│     │   │  └─ Q1.c
│     │   │  └─ Q2.c
|
├─ tests
│     └─ test_Q1.c
│     └─ test_Q2.c
</pre></div>
</div>
<p>The clang fixtures provided by pyAutoMark will set up the compilation include directories to point to the appropriate test folder and student folder. Compilation is performed as one unit with the students file included automatically at the beginning of the unit test C file.</p>
<p>To be collected the C test filenames must start with “test_” and contain
the following definitions</p>
<dl class="field-list simple">
<dt class="field-odd">PYAM_TEST</dt>
<dd class="field-odd"><p>A unix glob string used to find the students file under test.</p>
</dd>
<dt class="field-even">PYAM_TIMEOUT</dt>
<dd class="field-even"><p>(Optional) A floating point value spcifying the timeout for these tests.</p>
</dd>
<dt class="field-odd">PYAM_LINT</dt>
<dd class="field-odd"><p>(Optional) A number specifying the naximum number of LINT warnings allowed
for the test to pass and optionally followed by the list of LINT checks to perform</p>
</dd>
<dt class="field-even">PYAM_CFLAGS</dt>
<dd class="field-even"><p>(Optional) Quoted list of options for the compiler e.g. optimisations, language features etc</p>
</dd>
<dt class="field-odd">PYAM_LINK</dt>
<dd class="field-odd"><p>(Optional) Quoted list of extra link options e.g. “-lm” to link the math library etc.</p>
</dd>
</dl>
<p>e.g.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#DEFINE PYAM_TEST &quot;UUT.c&quot;</span>
<span class="cp">#DEFINE PYAM_LINT N,CHECKS</span>
<span class="cp">#DEFINE PYAM_TIMEOUT TIMEOUT</span>
<span class="cp">#DEFINE PYAM_CFLAGS &quot;C_OPTIONS&quot;</span>
<span class="cp">#DEFINE PYAM_LINK &quot;LINK_OPTIONS&quot;</span>
</pre></div>
</div>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-UUT.c">
<span id="cmdoption-arg-uut-c"></span><span class="sig-name descname"><span class="pre">UUT.c</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-UUT.c" title="Permalink to this definition">¶</a></dt>
<dd><p>The filename glob in the students directory</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-N">
<span id="cmdoption-arg-n"></span><span class="sig-name descname"><span class="pre">N</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-N" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of warnings to allow before a lint check is considered a fail.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-CHECKS">
<span id="cmdoption-arg-checks"></span><span class="sig-name descname"><span class="pre">CHECKS</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-CHECKS" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of checks (passed to clang-tidy)</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-TIMEOUT">
<span id="cmdoption-arg-timeout"></span><span class="sig-name descname"><span class="pre">TIMEOUT</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-TIMEOUT" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum run time for a test in seconds.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-C_OPTIONS">
<span id="cmdoption-arg-c-options"></span><span class="sig-name descname"><span class="pre">C_OPTIONS</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-C_OPTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>List of options for the compiler e.g. optimisations, language features etc</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-LINK_OPTIONS">
<span id="cmdoption-arg-link-options"></span><span class="sig-name descname"><span class="pre">LINK_OPTIONS</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-LINK_OPTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra link options e.g. “-lm” to link the math library etc.</p>
</dd></dl>

<p>For each test that we want to perform this code will be compiled and and then executed with a different definition set using the -d argument on the compiler. We therefore use <code class="code docutils literal notranslate"><span class="pre">#ifdef</span></code> or <code class="code docutils literal notranslate"><span class="pre">#ifdefined</span></code> blocks in the C program
to select which test we want to carry out. To be recognised as tests the definitions must start with with “TEST_”. e.g.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdefined TEST_MYTEST</span>
<span class="c1">// Your test code here</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">C</a><ul>
<li><a class="reference internal" href="#directory-structure">Directory structure</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../cmds/write-csv.html"
                        title="previous chapter">write-csv</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cmock.html"
                        title="next chapter">Embedded C using the C mock fixtures</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/clang.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cmock.html" title="Embedded C using the C mock fixtures"
             >next</a> |</li>
        <li class="right" >
          <a href="../cmds/write-csv.html" title="write-csv"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyAutoMark 0.8.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">C</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023-2023, John Williams.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>